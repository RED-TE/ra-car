# ğŸ Ricar Admin - ì• í”Œ ìŠ¤íƒ€ì¼ ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

## âœ¨ ìƒˆë¡œìš´ ê¸°ëŠ¥

### 1. ì• í”Œ ë””ìì¸
- SF Pro Display í°íŠ¸ ìŠ¤íƒ€ì¼
- ë¶€ë“œëŸ¬ìš´ ë¸”ëŸ¬ íš¨ê³¼ (backdrop-filter)
- ë¯¸ë‹ˆë©€í•œ ìƒ‰ìƒ (íšŒìƒ‰ + íŒŒë€ìƒ‰)
- ë‘¥ê·¼ ëª¨ì„œë¦¬ + ë„“ì€ ì—¬ë°±

### 2. ì™„ì „í•œ ì‚¬ìš©ì ì¶”ì 
- âœ… **ê°€ì…ë§Œ í•œ ì‚¬ìš©ìë„ ëª¨ë‘ í‘œì‹œ**
- âœ… **í”„ë¡œê·¸ë¨ ì‹¤í–‰ ë¡œê·¸ ìˆ˜ì§‘ ë° í‘œì‹œ**
- âœ… **ë¬´ë£Œ ì´ìš©ì ìƒì„¸ ì¶”ì **
- âœ… **ì´ìƒ ì‚¬ìš© ì˜ì‹¬ ìë™ ê°ì§€**

### 3. ì´ìƒ ì‚¬ìš© ì˜ì‹¬ ë¡œì§
ìë™ìœ¼ë¡œ ê°ì§€:
1. ë¬´ë£Œ ì‚¬ìš©ìê°€ 2íšŒ ì´ìƒ ì‹¤í–‰ ğŸš¨
2. 3ëŒ€ ì´ìƒ ê¸°ê¸°ì—ì„œ ì‹¤í–‰
3. ì´ 10íšŒ ì´ìƒ ì‹¤í–‰
4. ë§Œë£Œ í›„ ê³„ì† ì‹¤í–‰ ì‹œë„

---

## ğŸš€ ë¹ ë¥¸ ì ìš© (5ë¶„)

### 1ë‹¨ê³„: íŒŒì¼ êµì²´
```
ê¸°ì¡´ íŒŒì¼:
- ricar_mgr_7468_gate.html
- ricar_mgr_7468_gate.js

ìƒˆ íŒŒì¼:
- ricar_mgr_7468_gate_apple.html  â† ì—…ë¡œë“œ
- ricar_mgr_7468_gate_apple.js     â† ì—…ë¡œë“œ
```

### 2ë‹¨ê³„: ì ‘ì†
```
https://your-domain.com/ricar_mgr_7468_gate_apple.html
```

### 3ë‹¨ê³„: ë¡œê·¸ì¸
ê´€ë¦¬ì ì´ë©”ì¼: `jhxox666@gmail.com`ë¡œ ë¡œê·¸ì¸

---

## ğŸ“Š ëŒ€ì‹œë³´ë“œ êµ¬ì„±

### ìƒë‹¨ í†µê³„ (5ê°œ ì¹´ë“œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì „ì²´ ê°€ì…ì â”‚ í™œì„± í”Œëœ   â”‚ ë¬´ë£Œ ì´ìš©ì â”‚ ì˜¤ëŠ˜ ë§Œë£Œ   â”‚ ì´ìƒ ì‚¬ìš©   â”‚
â”‚    125      â”‚     48      â”‚     77      â”‚      3      â”‚      8      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### íƒ­ êµ¬ì„±
1. **ì „ì²´ ì‚¬ìš©ì** - ëª¨ë“  ì‚¬ìš©ì ëª©ë¡
2. **ì´ìƒ ì‚¬ìš© ì˜ì‹¬** - ì˜ì‹¬ ì‚¬ìš©ìë§Œ í•„í„°ë§
3. **ë¬´ë£Œ ì´ìš©ì** - ë¬´ë£Œ í”Œëœ ìƒì„¸

---

## ğŸ”§ Python í´ë¼ì´ì–¸íŠ¸ ë¡œê·¸ ìˆ˜ì§‘

### 1. í•„ìš”í•œ íŒ¨í‚¤ì§€
```bash
pip install firebase-admin --break-system-packages
```

### 2. ì½”ë“œ ì¶”ê°€ (main.py)

```python
import firebase_admin
from firebase_admin import credentials, firestore
from datetime import datetime
import platform
import uuid

# Firebase ì´ˆê¸°í™” (í•œ ë²ˆë§Œ)
if not firebase_admin._apps:
    cred = credentials.Certificate("serviceAccountKey.json")
    firebase_admin.initialize_app(cred)
db = firestore.client()

class RicarLogger:
    def __init__(self, user_id, hwid):
        self.user_id = user_id
        self.hwid = hwid
        self.start_time = datetime.now()
        self.current_step = "ì‹œì‘"
        
    def log_step(self, step_name):
        """ê° ë‹¨ê³„ë§ˆë‹¤ í˜¸ì¶œ"""
        self.current_step = step_name
        print(f"[LOG] {step_name}")
        
    def log_success(self):
        """ì„±ê³µ ì‹œ í˜¸ì¶œ"""
        self._save_log("success", None)
        
    def log_error(self, error_message):
        """ì—ëŸ¬ ì‹œ í˜¸ì¶œ"""
        self._save_log("error", error_message)
        
    def _save_log(self, status, error=None):
        try:
            user_ref = db.collection('users').document(self.user_id)
            
            log_entry = {
                'timestamp': datetime.now(),
                'hwid': self.hwid,
                'lastStep': self.current_step,
                'status': status,
                'duration': (datetime.now() - self.start_time).total_seconds(),
                'platform': platform.system(),
            }
            
            if error:
                log_entry['error'] = error
            
            user_ref.update({
                'executionLogs': firestore.ArrayUnion([log_entry]),
                'lastExecutionLog': log_entry,
                'totalExecutions': firestore.Increment(1),
                'updatedAt': datetime.now()
            })
            
            print(f"âœ… ë¡œê·¸ ì €ì¥: {status}")
        except Exception as e:
            print(f"âŒ ë¡œê·¸ ì €ì¥ ì‹¤íŒ¨: {e}")

# ì‚¬ìš© ì˜ˆì‹œ
def main():
    user_id = "user_hwid_or_uid"
    hwid = str(uuid.UUID(int=uuid.getnode()))
    
    logger = RicarLogger(user_id, hwid)
    
    try:
        logger.log_step("ë¡œê·¸ì¸ ì¤‘")
        # ë¡œê·¸ì¸ ë¡œì§...
        
        logger.log_step("ë¸”ë¡œê·¸ ì‘ì„± ì¤‘")
        # ë¸”ë¡œê·¸ ì‘ì„±...
        
        logger.log_step("ë°œí–‰ ì™„ë£Œ")
        logger.log_success()
        
    except Exception as e:
        logger.log_error(str(e))

if __name__ == "__main__":
    main()
```

### 3. ë¬´ë£Œ ì²´í—˜ ì œí•œ ì²´í¬

```python
def check_free_trial(user_id):
    """ë¬´ë£Œ ì²´í—˜ ì œí•œ í™•ì¸"""
    try:
        user_ref = db.collection('users').document(user_id)
        user_doc = user_ref.get()
        
        if user_doc.exists:
            data = user_doc.to_dict()
            plan = data.get('plan', 'free')
            free_count = data.get('freeTrialCount', 0)
            
            # ë¬´ë£Œ í”Œëœì´ê³  2íšŒ ì´ìƒì´ë©´ ì°¨ë‹¨
            if plan == 'free' and free_count >= 2:
                print(f"âš ï¸ ë¬´ë£Œ ì²´í—˜ ì œí•œ ì´ˆê³¼: {free_count}íšŒ")
                return False
            
            # ì¹´ìš´íŠ¸ ì¦ê°€
            if plan == 'free':
                user_ref.update({
                    'freeTrialCount': firestore.Increment(1)
                })
                
        return True
        
    except Exception as e:
        print(f"âŒ ì²´í—˜ ì²´í¬ ì‹¤íŒ¨: {e}")
        return True  # ì—ëŸ¬ ì‹œ ì‹¤í–‰ í—ˆìš©
```

---

## ğŸ“ Firestore ë°ì´í„° êµ¬ì¡°

### users ì»¬ë ‰ì…˜
```javascript
{
  // ê¸°ë³¸
  email: "user@example.com",
  hwid: "ABC123...",
  plan: "lite" | "pro" | "free",
  
  // ë‚ ì§œ
  expiryDate: Timestamp,
  createdAt: Timestamp,
  updatedAt: Timestamp,
  
  // ì¶”ì  (ìƒˆë¡œ ì¶”ê°€)
  totalExecutions: 15,        // ì´ ì‹¤í–‰
  freeTrialCount: 2,          // ë¬´ë£Œ ì‹¤í–‰
  deviceIds: ["hwid1", ...],  // ê¸°ê¸° ëª©ë¡
  
  // ë¡œê·¸ (ìƒˆë¡œ ì¶”ê°€)
  executionLogs: [
    {
      timestamp: Timestamp,
      hwid: "ABC...",
      lastStep: "ë¸”ë¡œê·¸ ì‘ì„± ì¤‘",
      status: "success" | "error",
      duration: 123.45,
      platform: "Windows",
      error: "ì—ëŸ¬ ë©”ì‹œì§€"
    }
  ],
  lastExecutionLog: { ... },
  
  // ì˜ì‹¬ (ìë™ ì„¤ì •)
  suspiciousActivity: true,
  suspiciousReason: "ë¬´ë£Œ 3íšŒ ì‹¤í–‰, 5ëŒ€ ê¸°ê¸°"
}
```

---

## ğŸ¨ UI ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ìƒ‰ìƒ ë³€ê²½
`ricar_mgr_7468_gate_apple.html`:

```css
.apple-button {
    background: #3b82f6;  /* íŒŒë€ìƒ‰ */
}

.badge-active {
    color: #22c55e;  /* ì´ˆë¡ìƒ‰ */
}
```

### ì´ìƒ ì‚¬ìš© ì¡°ê±´ ë³€ê²½
`ricar_mgr_7468_gate_apple.js`:

```javascript
function analyzeSuspiciousActivity() {
    suspiciousUsers = allUsers.filter(user => {
        // ì¡°ê±´ ë³€ê²½
        if (user.freeTrialCount >= 3) {  // 2â†’3ìœ¼ë¡œ ë³€ê²½
            return true;
        }
        // ...
    });
}
```

---

## â“ ë¬¸ì œ í•´ê²°

### Q1. "ì‚¬ìš©ìê°€ í‘œì‹œë˜ì§€ ì•Šì•„ìš”"
**A:** Firestore ê·œì¹™ í™•ì¸
```javascript
allow read: if request.auth != null;
```

### Q2. "ë¡œê·¸ê°€ ì €ì¥ë˜ì§€ ì•Šì•„ìš”"
**A:** 
1. `serviceAccountKey.json` íŒŒì¼ í™•ì¸
2. Firebase SDK ë²„ì „ í™•ì¸
3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸

### Q3. "ì´ìƒ ì‚¬ìš© ê°ì§€ ì•ˆ ë¼ìš”"
**A:**
1. `analyzeSuspiciousActivity()` í•¨ìˆ˜ í™•ì¸
2. ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬ í™•ì¸
3. ë°ì´í„° êµ¬ì¡° í™•ì¸

---

## ğŸ’¡ íŒ

### 1. ìë™ ìƒˆë¡œê³ ì¹¨
```javascript
// ricar_mgr_7468_gate_apple.js ë§ˆì§€ë§‰ ì¶”ê°€
setInterval(loadAllData, 60000); // 1ë¶„ë§ˆë‹¤
```

### 2. CSV ë‚´ë³´ë‚´ê¸°
```javascript
function exportCSV() {
    const csv = allUsers.map(u => 
        `${u.email},${u.plan},${u.totalExecutions}`
    ).join('\n');
    
    const blob = new Blob([csv], { type: 'text/csv' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'users.csv';
    a.click();
}
```

---

## ğŸ“ ì§€ì›

ë¬¸ì œ ë°œìƒ ì‹œ:
1. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ (F12) í™•ì¸
2. Firebase ì½˜ì†” í™•ì¸
3. Python ì½˜ì†” ì¶œë ¥ í™•ì¸

**ì™„ì„±!** ğŸ‰
