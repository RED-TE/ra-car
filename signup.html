<!DOCTYPE html>
<html class="light" lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>회원가입 - 리카봇 (RicarBot)</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0f1729",
                        "background-light": "#f6f7f8",
                        "background-dark": "#14171e",
                        "slate": {
                            50: "#f8fafc",
                            100: "#f1f5f9",
                            200: "#e2e8f0",
                            300: "#cbd5e1",
                            400: "#94a3b8",
                            500: "#64748b",
                            600: "#475569",
                            700: "#334155",
                            800: "#1e293b",
                            900: "#0f172a",
                        }
                    },
                    fontFamily: {
                        "display": ["Inter", "Noto Sans KR", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }

        .form-input:focus {
            border-color: #0f1729;
            --tw-ring-color: #0f1729;
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex flex-col">
    <header class="w-full max-w-7xl mx-auto px-6 py-8 flex justify-between items-center">
        <div class="flex items-center gap-2 group cursor-pointer" onclick="location.href='index.html'">
            <div class="bg-primary text-white p-1.5 rounded-lg flex items-center justify-center">
                <span class="material-symbols-outlined text-2xl">rocket_launch</span>
            </div>
            <h1 class="text-xl font-bold tracking-tight text-slate-900 dark:text-slate-100">리카봇 <span
                    class="text-slate-500 font-medium">RicarBot</span></h1>
        </div>
        <div class="hidden sm:flex items-center gap-2 text-slate-500 text-sm">
            <span class="material-symbols-outlined text-sm">lock</span>
            <span>안전한 보안 인증 시스템을 사용합니다</span>
        </div>
    </header>
    <main class="flex-1 flex items-center justify-center px-4 py-12">
        <div
            class="w-full max-w-[480px] bg-white dark:bg-slate-900 rounded-xl shadow-xl shadow-slate-200/50 dark:shadow-none border border-slate-200 dark:border-slate-800 p-8 md:p-10">
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-slate-900 dark:text-slate-100">회원가입</h2>
                <p class="text-slate-500 dark:text-slate-400 mt-2">리카봇과 함께 비즈니스를 혁신하세요.</p>
            </div>

            <!-- Error Message -->
            <div class="hidden mb-6 p-3 rounded-lg bg-red-50 border border-red-100 flex items-center gap-2 text-red-600 text-sm"
                id="errorMessage">
                <span class="material-symbols-outlined text-[18px]">error</span>
                <span id="errorText">문제가 발생했습니다.</span>
            </div>

            <form class="space-y-5" onsubmit="return false;">
                <div>
                    <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2" for="email">이메일
                        주소</label>
                    <input
                        class="form-input w-full px-4 py-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary/20 outline-none transition-all"
                        id="email" placeholder="name@company.com" type="email" />
                </div>
                <div>
                    <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"
                        for="password">비밀번호</label>
                    <input
                        class="form-input w-full px-4 py-3 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary/20 outline-none transition-all"
                        id="password" placeholder="6자 이상 입력해주세요" type="password" />
                </div>

                <div class="pt-4 border-t border-slate-100 dark:border-slate-800">
                    <div class="flex items-center mb-4">
                        <input class="w-5 h-5 text-primary border-slate-300 rounded focus:ring-primary" id="check-all"
                            type="checkbox" />
                        <label class="ml-3 text-base font-bold text-slate-900 dark:text-slate-100 cursor-pointer"
                            for="check-all">전체 동의</label>
                    </div>
                    <div class="space-y-3 pl-1">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input
                                    class="consent-check required-check w-4 h-4 text-primary border-slate-300 rounded focus:ring-primary"
                                    id="check-age" type="checkbox" />
                                <label class="ml-3 text-sm text-slate-600 dark:text-slate-400 cursor-pointer"
                                    for="check-age">만 14세 이상입니다 <span
                                        class="text-slate-400 dark:text-slate-500">(필수)</span></label>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input
                                    class="consent-check required-check w-4 h-4 text-primary border-slate-300 rounded focus:ring-primary"
                                    id="check-terms" type="checkbox" />
                                <label class="ml-3 text-sm text-slate-600 dark:text-slate-400 cursor-pointer"
                                    for="check-terms">이용약관 동의 <span
                                        class="text-slate-400 dark:text-slate-500">(필수)</span></label>
                            </div>
                            <a class="text-xs text-slate-400 hover:text-primary underline" href="license_old.html"
                                target="_blank">보기</a>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input
                                    class="consent-check required-check w-4 h-4 text-primary border-slate-300 rounded focus:ring-primary"
                                    id="check-privacy" type="checkbox" />
                                <label class="ml-3 text-sm text-slate-600 dark:text-slate-400 cursor-pointer"
                                    for="check-privacy">개인정보처리방침 동의 <span
                                        class="text-slate-400 dark:text-slate-500">(필수)</span></label>
                            </div>
                            <a class="text-xs text-slate-400 hover:text-primary underline"
                                href="privacy_policy_ricarautoplan_multi_pg_nolist.html" target="_blank">보기</a>
                        </div>
                        <div class="flex items-center">
                            <input
                                class="consent-check w-4 h-4 text-primary border-slate-300 rounded focus:ring-primary"
                                id="check-marketing" type="checkbox" />
                            <label class="ml-3 text-sm text-slate-600 dark:text-slate-400 cursor-pointer"
                                for="check-marketing">마케팅 정보 수신 동의 <span
                                    class="text-slate-400 dark:text-slate-500">(선택)</span></label>
                        </div>
                    </div>
                </div>
                <button
                    class="w-full bg-primary hover:bg-slate-800 text-white font-semibold py-4 rounded-lg shadow-lg shadow-primary/10 transition-all transform active:scale-[0.98] mt-4"
                    id="emailSignupBtn">
                    회원가입 완료
                </button>
            </form>
            <div class="mt-8 text-center border-t border-slate-100 dark:border-slate-800 pt-6">
                <p class="text-sm text-slate-500 dark:text-slate-400">
                    이미 계정이 있으신가요?
                    <a class="text-primary dark:text-slate-200 font-bold ml-2 hover:underline" href="login.html">로그인</a>
                </p>
            </div>
        </div>
    </main>
    <footer
        class="w-full max-w-7xl mx-auto px-6 py-8 flex flex-col md:flex-row justify-between items-center gap-4 text-slate-400 text-xs">
        <div class="flex gap-6">
            <a class="hover:text-slate-600 transition-colors" href="license_old.html">이용약관</a>
            <a class="hover:text-slate-600 transition-colors"
                href="privacy_policy_ricarautoplan_multi_pg_nolist.html">개인정보처리방침</a>
            <a class="hover:text-slate-600 transition-colors" href="mailto:jhxox666@naver.com">고객센터</a>
        </div>
        <div class="text-slate-400">
            © 2026 RicarBot Inc. All rights reserved.
        </div>
    </footer>

    <!-- Firebase SDK (Compat Version) -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="firebase_config.js"></script>

    <script>
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');

        // Check All Logic
        const checkAll = document.getElementById('check-all');
        const checkboxes = document.querySelectorAll('.consent-check');
        checkAll.addEventListener('change', (e) => {
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        });
        checkboxes.forEach(cb => {
            cb.addEventListener('change', () => {
                checkAll.checked = Array.from(checkboxes).every(c => c.checked);
            });
        });

        // Email Signup Handler
        document.getElementById('emailSignupBtn').addEventListener('click', async () => {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();

            const requiredChecks = document.querySelectorAll('.required-check');
            let allChecked = true;
            requiredChecks.forEach(cb => { if (!cb.checked) allChecked = false; });

            if (!allChecked) {
                showError('필수 약관 및 연령 확인에 모두 동의해주세요.');
                return;
            }

            if (!email || !password) {
                showError('이메일과 비밀번호를 모두 입력해주세요.');
                return;
            }
            if (password.length < 6) {
                showError('비밀번호는 최소 6자리 이상이어야 합니다.');
                return;
            }

            try {
                const result = await auth.createUserWithEmailAndPassword(email, password);
                const user = result.user;
                const marketingConsent = document.getElementById('check-marketing').checked;

                if (typeof db !== 'undefined') {
                    await db.collection("users").doc(user.uid).set({
                        email: user.email,
                        createdAt: new Date(),
                        plan: 'free',
                        role: 'user',
                        authProvider: 'email',
                        termsAgreed: true,
                        marketingConsent: marketingConsent,
                        agreedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }

                alert('회원가입이 완료되었습니다! 반갑습니다.');
                window.location.href = 'index.html';
            } catch (error) {
                console.error("Email Signup Error:", error);
                let msg = `회원가입 실패: ${error.message}`;
                if (error.code === 'auth/email-already-in-use') msg = '이미 사용 중인 이메일입니다.';
                if (error.code === 'auth/invalid-email') msg = '유효하지 않은 이메일 형식입니다.';
                showError(msg);
            }
        });

        function showError(msg) {
            errorText.textContent = msg;
            errorMessage.classList.remove('hidden');
        }
    </script>
</body>

</html>